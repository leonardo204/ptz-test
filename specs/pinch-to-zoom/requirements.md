# 요구사항 문서

## 소개

이 문서는 핀치 투 줌 제스처를 기반으로 한 다단계 텍스트 요약 제공 시스템의 MVP(Minimum Viable Product) 요구사항을 정의합니다. 이 시스템은 사용자가 텍스트의 요약 수준을 실시간으로 조절할 수 있는 인터랙티브한 웹 애플리케이션입니다. 특히 단어 단위의 그라디언트 애니메이션을 통해 자연스러운 전환을 제공하며, 모바일과 데스크톱 모두에서 직관적인 사용자 경험을 제공합니다.

## 요구사항

### 요구사항 1: 텍스트 표시 및 레벨 관리

**사용자 스토리:** 사용자로서, 나는 원문과 여러 수준의 요약을 볼 수 있기를 원한다. 그래서 내가 필요한 정보의 깊이를 선택할 수 있다.

#### 수락 기준
1. WHEN 사용자가 애플리케이션을 처음 로드할 때 THEN 시스템은 Level 0(원문)을 표시해야 한다
2. IF example.txt 파일이 존재한다면 THEN 시스템은 해당 파일의 내용을 문단 구조를 유지하면서 표시해야 한다
3. WHEN 사용자가 텍스트를 보고 있을 때 THEN 시스템은 Level 0부터 Level 3까지 총 4단계의 요약 레벨을 제공해야 한다
4. IF 요약이 생성되었다면 THEN 각 레벨은 다음 압축률을 만족해야 한다:
   - Level 0: 원문 100%
   - Level 1: 원문의 70-80%
   - Level 2: 원문의 40-50%
   - Level 3: 원문의 10-20%

### 요구사항 2: 핀치 투 줌 시뮬레이션

**사용자 스토리:** 데스크톱 사용자로서, 나는 버튼을 통해 핀치 투 줌을 시뮬레이션하고 싶다. 그래서 마우스로도 요약 레벨을 조절할 수 있다.

#### 수락 기준
1. WHEN 사용자가 화면을 볼 때 THEN 시스템은 '-'와 '+' 버튼을 표시해야 한다
2. WHEN 사용자가 '-' 버튼을 클릭할 때 THEN 시스템은 요약 레벨을 증가시켜야 한다 (Level 0 → 1 → 2 → 3)
3. WHEN 사용자가 '+' 버튼을 클릭할 때 THEN 시스템은 요약 레벨을 감소시켜야 한다 (Level 3 → 2 → 1 → 0)
4. IF 사용자가 Level 0에 있고 '+' 버튼을 클릭한다면 THEN 시스템은 Level 0을 유지해야 한다
5. IF 사용자가 Level 3에 있고 '-' 버튼을 클릭한다면 THEN 시스템은 Level 3을 유지해야 한다

### 요구사항 3: 모바일 핀치 투 줌

**사용자 스토리:** 모바일 사용자로서, 나는 실제 핀치 제스처로 요약 레벨을 조절하고 싶다. 그래서 직관적으로 텍스트 밀도를 제어할 수 있다.

#### 수락 기준
1. WHEN 모바일 기기에서 애플리케이션에 접속할 때 THEN 시스템은 터치 이벤트를 감지해야 한다
2. WHEN 사용자가 두 손가락으로 핀치 아웃(벌리기) 제스처를 할 때 THEN 시스템은 요약 레벨을 감소시켜야 한다
3. WHEN 사용자가 두 손가락으로 핀치 인(좁히기) 제스처를 할 때 THEN 시스템은 요약 레벨을 증가시켜야 한다
4. IF 핀치 거리가 다음 범위에 있다면 THEN 시스템은 해당 레벨을 표시해야 한다:
   - 거리 > 80%: Level 0
   - 60% < 거리 ≤ 80%: Level 1
   - 40% < 거리 ≤ 60%: Level 2
   - 거리 ≤ 40%: Level 3

### 요구사항 4: 그라디언트 애니메이션 전환

**사용자 스토리:** 사용자로서, 나는 레벨 전환 시 부드러운 애니메이션을 보고 싶다. 그래서 어떤 단어가 사라지고 추가되는지 명확히 인지할 수 있다.

#### 수락 기준
1. WHEN 레벨이 전환될 때 THEN 시스템은 단어 단위로 차이를 분석해야 한다
2. WHEN 단어가 제거될 때 THEN 시스템은 300ms 동안 페이드아웃 애니메이션을 실행해야 한다
3. WHEN 단어가 추가될 때 THEN 시스템은 300ms 동안 페이드인 애니메이션을 실행해야 한다
4. IF 여러 단어가 동시에 변경된다면 THEN 시스템은 우선순위에 따라 순차적으로 애니메이션을 실행해야 한다
5. WHEN 애니메이션이 실행될 때 THEN 시스템은 ease-out 곡선을 적용해야 한다
6. IF 애니메이션이 진행 중일 때 THEN 시스템은 60fps를 유지해야 한다

### 요구사항 5: LLM 기반 요약 생성

**사용자 스토리:** 사용자로서, 나는 의미가 보존된 품질 높은 요약을 보고 싶다. 그래서 각 레벨에서도 핵심 내용을 이해할 수 있다.

#### 수락 기준
1. WHEN 텍스트가 로드될 때 THEN 시스템은 LLM을 사용하여 3개의 요약 레벨을 생성해야 한다
2. IF Level 1 요약을 생성할 때 THEN 시스템은 TF-IDF 상위 30% 키워드를 보존해야 한다
3. IF Level 2 요약을 생성할 때 THEN 시스템은 의미 유사도 0.75 이상을 유지해야 한다
4. IF Level 3 요약을 생성할 때 THEN 시스템은 3-5문장으로 핵심만 추출해야 한다
5. WHEN 요약이 생성될 때 THEN 시스템은 각 레벨에 맞는 프롬프트 전략을 사용해야 한다
6. IF 요약 생성이 완료되면 THEN 시스템은 결과를 캐싱해야 한다

### 요구사항 6: 단어 우선순위 계산

**사용자 스토리:** 사용자로서, 나는 중요한 단어가 마지막까지 유지되기를 원한다. 그래서 핵심 내용을 놓치지 않을 수 있다.

#### 수락 기준
1. WHEN 단어의 우선순위를 계산할 때 THEN 시스템은 다음 공식을 사용해야 한다:
   - P = 0.4×TF-IDF + 0.3×품사 + 0.2×구문의존성 + 0.1×위치
2. IF 단어가 명사라면 THEN 시스템은 품사 가중치 1.0을 부여해야 한다
3. IF 단어가 접속사라면 THEN 시스템은 품사 가중치 0.05를 부여해야 한다
4. WHEN 우선순위가 계산되면 THEN 시스템은 단어를 3개 그룹으로 분류해야 한다:
   - P < 0.3: 즉시 제거 그룹
   - 0.3 ≤ P < 0.6: 중간 제거 그룹
   - P ≥ 0.6: 후반 제거 그룹

### 요구사항 7: 웹 서버 및 환경 설정

**사용자 스토리:** 개발자로서, 나는 표준 Node.js 환경에서 애플리케이션을 실행하고 싶다. 그래서 쉽게 배포하고 관리할 수 있다.

#### 수락 기준
1. WHEN 애플리케이션이 시작될 때 THEN 시스템은 Node.js 기반 웹 서버를 실행해야 한다
2. IF 서버가 포트를 바인딩할 때 THEN 시스템은 포트 3135를 사용해야 한다
3. WHEN 클라이언트가 접속할 때 THEN 시스템은 정적 파일과 API 엔드포인트를 제공해야 한다
4. IF 환경 변수 PORT가 설정되지 않았다면 THEN 시스템은 기본 포트 3135를 사용해야 한다

### 요구사항 8: 프롬프트 관리

**사용자 스토리:** 개발자로서, 나는 LLM 프롬프트를 체계적으로 관리하고 싶다. 그래서 요약 품질을 쉽게 개선할 수 있다.

#### 수락 기준
1. WHEN 시스템이 요약을 생성할 때 THEN 각 레벨별로 정의된 프롬프트 템플릿을 사용해야 한다
2. IF 프롬프트가 정의될 때 THEN 시스템은 구조화된 형태로 프롬프트를 저장해야 한다
3. WHEN 프롬프트가 사용될 때 THEN 시스템은 동적으로 컨텍스트를 주입할 수 있어야 한다
4. IF 프롬프트가 수정되면 THEN 시스템은 재시작 없이 변경사항을 적용할 수 있어야 한다

### 요구사항 9: 성능 최적화

**사용자 스토리:** 사용자로서, 나는 빠르고 부드러운 인터페이스를 경험하고 싶다. 그래서 스트레스 없이 텍스트를 탐색할 수 있다.

#### 수락 기준
1. WHEN 단어 매칭 알고리즘이 실행될 때 THEN 처리 시간은 50ms 이내여야 한다
2. IF 애니메이션이 실행될 때 THEN 시스템은 GPU 가속을 활용해야 한다
3. WHEN 요약이 생성될 때 THEN 시스템은 비동기적으로 처리해야 한다
4. IF 동일한 텍스트에 대한 요청이 있다면 THEN 시스템은 캐싱된 결과를 사용해야 한다

### 요구사항 10: 사용자 위치 보존

**사용자 스토리:** 사용자로서, 나는 레벨 전환 시에도 읽던 위치를 유지하고 싶다. 그래서 맥락을 잃지 않을 수 있다.

#### 수락 기준
1. WHEN 레벨이 전환되기 전 THEN 시스템은 현재 뷰포트의 중심 단어를 추적해야 한다
2. WHEN 레벨 전환이 완료되면 THEN 시스템은 추적된 단어가 화면 중앙에 오도록 스크롤을 조정해야 한다
3. IF 추적된 단어가 새 레벨에 존재하지 않는다면 THEN 시스템은 가장 가까운 유사 단어를 찾아야 한다